<!-- views/add.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Entry</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <h1 class="header">Add New Anime Entry</h1>
        <form class="form-container" action="/add" method="POST" id="addEntryForm">
            <label for="animeSelect">Anime:</label>
             <select id="animeSelect" name="animeTitle" required>
            <!-- Options will be populated with JavaScript -->
            </select>
             <input type="hidden" id="image_url" name="image_url">

            <label for="progress">Progress:</label>
            <select id="progress" name="progress" required>
                <option value="Just Started">Just Started</option>
                <option value="In Progress">In Progress</option>
                <option value="Finished">Finished</option>
            </select><br>

            <label for="rating">Rating:</label>
            <input type="number" id="rating" name="rating" min="0" max="10" step="0.1" required><br>

            <label for="summary">Summary:</label>
            <textarea id="summary" name="summary" required></textarea><br>

            <label for="spoiler">Does it include spoilers?</label>
            <input type="checkbox" id="spoiler" name="spoiler"><br>

            <button type="submit">Add Entry</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const response = await fetch('/api/popular-anime');
            const animeList = await response.json();

            const animeSelect = document.getElementById('animeSelect');
            animeList.forEach(anime => {
                const option = document.createElement('option');
                option.value = anime.id;
                option.text = anime.title.romaji;
                option.setAttribute('data-image-url', anime.coverImage.large);
                animeSelect.appendChild(option);
            });

            animeSelect.addEventListener('change', function() {
                const selectedOption = animeSelect.selectedOptions[0];
                const imageUrl = selectedOption.getAttribute('data-image-url');
                document.getElementById('image_url').value = imageUrl;
            });
        });
    </script>
</body>
</html>


